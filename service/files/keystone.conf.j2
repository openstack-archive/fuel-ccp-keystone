[DEFAULT]
debug = {{ keystone.debug }}
use_syslog = False
use_stderr = True
max_token_size = 255
{% if keystone.notifications.enable %}
notification_format = {{ keystone.notifications.format }}
{% endif %}

[database]
connection = mysql+pymysql://{{ keystone.db.username }}:{{ keystone.db.password }}@{{ address(service.database) }}/{{ keystone.db.name }}{% if db.tls.enabled %}?ssl_ca=/opt/ccp/etc/tls/ca.pem{% endif %}
max_retries = -1
max_overflow = 60

[cache]
enabled = True
backend = oslo_cache.memcache_pool
memcache_servers = {{ address('memcached', memcached.port) }}
memcache_dead_retry = 60
memcache_socket_timeout = 1
memcache_pool_maxsize = 30

[token]
provider = fernet

[assignment]
driver = sql

{% if keystone.notifications.enable %}
[oslo_messaging_notifications]
driver = messagingv2
{% endif %}

{# rpc config required for notifications in stable/mitaka #}
{{ oslo_messaging[messaging.backend.rpc]('rpc_config') }}
{{ oslo_messaging[messaging.backend.notifications]('notifications_config') }}
