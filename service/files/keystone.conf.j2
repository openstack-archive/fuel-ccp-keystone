[DEFAULT]
debug = {{ keystone.debug }}
use_syslog = False
use_stderr = True
max_token_size = 255
{% if keystone.notifications.enable %}
notification_format = {{ keystone.notifications.format }}
{% endif %}

[database]
connection = mysql+pymysql://{{ keystone.db.username }}:{{ keystone.db.password }}@{{ address(service.database) }}/{{ keystone.db.name }}
max_retries = -1
max_overflow = 60

[cache]
enabled = True
backend = oslo_cache.memcache_pool
memcache_servers = {{ address('memcached', memcached.port) }}
memcache_dead_retry = 60
memcache_socket_timeout = 1
memcache_pool_maxsize = 30

[token]
provider = fernet

[assignment]
driver = sql

{% if keystone.notifications.enable %}
{# This section should be updated after https://review.openstack.org/#/c/419995/ is merged #}
[oslo_messaging_notifications]
driver = messagingv2
transport_url = rabbit://{{ rabbitmq.user }}:{{ rabbitmq.password }}@{{ address('rabbitmq', rabbitmq.port) }}
{% endif %}
